WASHINGTON (AP) — President Donald Trump is threatening to punish cities and other municipalities that shelter immigrants living in the country illegally by denying them federal dollars. Can a president do that? Most taxpayer money is beyond Trump's control. But a relatively small portion of the federal budget involves grants distributed by agency and Cabinet department heads appointed by Trump, and those programs could be affected. WHAT IS TRUMP THREATENING? Through a recent executive order and, on Sunday in an interview with Fox's Bill O'Reilly, Trump threatened to "defund" so-called sanctuary cities by taking away their federal grants. Those are cities and other municipalities that, generally speaking, shelter immigrants in the country illegally by refusing to help the federal government enforce immigration laws. Among the sanctuary cities are New York, Chicago and Los Angeles, as well as smaller jurisdictions like Takoma Park, Maryland, Cambridge, Massachusetts, and Chapel Hill, North Carolina. "I don't want to defund anybody. I want to give them the money they need to properly operate as a city or a state," Trump told O'Reilly. "If they're going to have sanctuary cities, we may have to do that. Certainly that would be a weapon." Just how big of a weapon isn't clear. Trump's threat was enough to prompt Miami-Dade County Mayor Carlos Gimenez, a Republican, to abandon its sanctuary status. But many other sanctuary cities are vowing to fight. WHAT MONEY WOULD TRUMP CUT OFF? As for Trump's defunding threat, the first thing to know is that the largest sources of federal funds are exempt from Trump's edict. Payments to individuals, such as Social Security or health benefits from Medicare, Medicaid or the Affordable Care Act are off the table. Other large pots of federal money — set by formula — such as highway funding and aid to disadvantaged schools are also exempt, as well as other programs like subsidized housing vouchers, heating subsidies for the poor and food stamps. What is left are discretionary grant programs. The order decrees that sanctuary jurisdictions "are not eligible to receive federal grants, except as deemed necessary for law enforcement purposes." That wording is very broad and could conceivably include grant programs that cities and states apply for and are distributed at the discretion of agency heads. Such funds include sewer and water grants distributed by the Environmental Protection Agency, money to help communities buy equipment for first responders such as firefighters, and special transportation grants established under President Barack Obama's 2009 economic stimulus bill. On the other hand, there's legal precedent that says the federal government has to establish a concrete tie between the funding it may cut off and what it is demanding of the states — in other words, the punishment is supposed to fit the crime. If applied so narrowly, the ban on funding for sanctuary cities could be limited to a handful of smaller programs within the departments of Justice and Homeland Security. Such more narrowly targeted programs include grants for justice assistance, police hiring and funds for programs combating violence against women. Another program partially reimburses state and local governments for the costs of keeping unauthorized immigrants in jail. WOULD THERE BE LEGAL CHALLENGES? Yes. The administration hasn't given detailed guidance on how the order will be enforced, but legal challenges are certain once it is used against a city or state. For one thing, critics say the order ignores legal precedent that holds that the federal government can't force the employees of local jurisdictions to enforce federal laws. For instance, a 1997 Supreme Court decision held that the feds can't force states to "enact or administer a federal regulatory program."     @AP on Twitter AP on Facebook AP Radio News: Your browser does not support the audio element.